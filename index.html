<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Live Parade Script</title>
<style>
  body {
    margin: 0;
    background: #000;
    color: #fff;
    font-family: "Arial", sans-serif;
    font-size: 2.2rem;
    line-height: 1.4;
    overflow: hidden;
  }
  #container {
    height: 100vh;
    overflow-y: auto;
    scroll-behavior: smooth;
    padding: 3rem;
  }
  .entry {
    margin-bottom: 3rem;
    padding: 1rem;
    border-left: 6px solid transparent;
    transition: border-color 0.5s ease;
  }
  .entry.active {
    border-color: #ffcc00;
    background: rgba(255, 204, 0, 0.1);
  }
  h2 {
    color: #ffcc00;
    margin: 0 0 0.5rem 0;
    font-size: 2.4rem;
  }
  p {
    margin: 0;
  }
</style>
</head>
<body>
<div id="container"></div>

<script>
const FEED_URL = "https://script.google.com/macros/s/AKfycbwHF1w0AOAsNW5okHOkXlldzaOotx7udEHtuVwdLhT1pHSlHPLZSrB22TOeh1oiqE44/exec";

let entries = [];
let currentIndex = 0;

// Fetch and refresh the feed
async function loadScript() {
  try {
    const res = await fetch(FEED_URL + "?t=" + Date.now()); // prevent caching
    entries = await res.json();

    if (!entries || entries.length === 0) {
      showNoDataMessage();
      return;
    }

    renderEntries();
  } catch (e) {
    console.error("Failed to fetch:", e);
    showNoDataMessage();
  }
}

// Render entries into the container
function renderEntries() {
  const container = document.getElementById("container");
  container.innerHTML = entries.map((e, i) => `
    <div class="entry" id="entry-${i}">
      <h2>${e.number}. ${e.organization}</h2>
      <p>${e.description}</p>
    </div>
  `).join("");
  highlightCurrent();
}

// Show friendly “waiting” message
function showNoDataMessage() {
  const container = document.getElementById("container");
  container.innerHTML = `
    <div style="text-align:center; margin-top:40vh;">
      <h2 style="color:#ffcc00;">Waiting for parade lineup...</h2>
      <p style="font-size:1.5rem; color:#ccc;">
        The live announcer feed will appear here as soon as the first group checks in.
      </p>
    </div>
  `;
}

// Highlight current entry and auto-scroll
function highlightCurrent() {
  const all = document.querySelectorAll(".entry");
  all.forEach(el => el.classList.remove("active"));
  const current = all[currentIndex];
  if (!current) return;
  current.classList.add("active");
  current.scrollIntoView({ behavior: "smooth", block: "center" });
}

// Automatically advance every 20 seconds (adjust as needed)
function autoAdvance() {
  if (entries.length === 0) return;
  currentIndex = (currentIndex + 1) % entries.length;
  highlightCurrent();
}

// Refresh data every 15 seconds
setInterval(loadScript, 15000);

// Scroll to next entry every 20 seconds
setInterval(autoAdvance, 20000);

// Initial load
loadScript();
</script>


</body>
</html>


